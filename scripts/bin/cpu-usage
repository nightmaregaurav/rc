#!/usr/bin/env -S uv run --script

# /// script
# requires-python = ">=3.14"
# dependencies = [
#   "psutil",
# ]
# ///

import sys

script_name = "cpu-usage"

HELP_MSG = f"""Usage: {script_name}

Show the current CPU usage in percentage.

Examples:
  {script_name}
"""

# Show help
if len(sys.argv) > 1 and sys.argv[1] in ("--help", "-h"):
    print(HELP_MSG)
    sys.exit(0)

try:
    import psutil
except ImportError:
    print("Error: 'psutil' module is required. Install it with 'pip install psutil'.")
    sys.exit(1)

# Get CPU usage over a short interval (0.5s) to average
cpu_percent = psutil.cpu_percent(interval=0.5)

# Print as single number like Bash script
print(f"{cpu_percent:.1f}")

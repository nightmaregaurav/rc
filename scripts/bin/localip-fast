#!/usr/bin/env -S uv run --script

# /// script
# requires-python = ">=3.14"
# dependencies = [
#     "argcomplete",
# ]
# ///

import os
import sys
import argparse
import argcomplete


def read_local_ip():
    ip_file = os.path.expanduser("~/.ip.local")
    if not os.path.exists(ip_file):
        print("Error: ~/.ip.local not found.")
        sys.exit(1)
    with open(ip_file, "r", encoding="utf-8") as f:
        print(f.read().strip())



def main():
    script_name = os.path.basename(sys.argv[0])

    parser = argparse.ArgumentParser(
        prog=script_name,
        description="Fetches the local IP address stored in ~/.ip.local if it exists.",
        epilog=f"Examples:\n  {script_name}",
        formatter_class=argparse.RawTextHelpFormatter,
        add_help=False,
    )

    parser.add_argument(
        "-h", "--help",
        action="help",
        help="Show help message and exit.",
    )

    argcomplete.autocomplete(parser, always_complete_options=False)
    parser.parse_args()

    read_local_ip()


if __name__ == "__main__":
    main()

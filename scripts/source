PATH="$current_rc_script_dir/scripts/bin:$PATH"

# Ensure scripts are executable
chmod 755 "$current_rc_script_dir/scripts/bin/"*

# Give ZSH the capability to complete commands using complete commands
if [ -n "$ZSH_VERSION" ]; then
    autoload -Uz compinit && compinit
    autoload -Uz bashcompinit && bashcompinit
fi

# Make sure all completion functions are sourced
# these files will be generated once register-rc-completions is run
if [ -d "$current_rc_script_dir/scripts/completions" ]; then
    for f in "$current_rc_script_dir"/scripts/completions/*-completion.sh; do
        [ -r "$f" ] && source "$f"
    done
fi

# Generic help completion function
_generic_help() {
    local cur
    COMPREPLY=()
    cur="${COMP_WORDS[COMP_CWORD]}"

    # Suggest only -h and --help
    COMPREPLY=( $(compgen -W "-h --help" -- "$cur") )
}

complete -o default -F _generic_help rc-setup-completions
complete -o default -F _generic_help rc-setup-uv
complete -o default -F _generic_help rc-update
